<!doctype html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Space Catch ‚ú®</title>
<style>
  body{margin:0;overflow:hidden;font-family:"Poppins",sans-serif;background:radial-gradient(circle at center,#090621,#0f1840);color:#fff;user-select:none;height:100vh;display:flex;align-items:center;justify-content:center;flex-direction:column}
  canvas{display:block;background:transparent;touch-action:none}
  #ui{position:absolute;top:10px;left:10px;right:10px;display:flex;justify-content:space-between;font-size:16px;text-shadow:0 0 5px #000}
  #overlay{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;background:rgba(0,0,0,0.6)}
  button{background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.15);color:#fff;padding:6px 14px;border-radius:8px;font-size:16px;cursor:pointer}
  .touch{position:absolute;bottom:20px;left:0;right:0;display:flex;justify-content:center;gap:30px}
  .touch-btn{background:rgba(255,255,255,0.08);border:1px solid rgba(255,255,255,0.15);border-radius:12px;padding:20px 40px;font-size:28px;color:#fff;user-select:none}
  .touch-btn:active{background:rgba(255,255,255,0.2);transform:scale(0.9)}
</style>
</head>
<body>
<canvas id="game"></canvas>

<div id="ui">
  <div>‚≠ê Skor: <span id="score">0</span></div>
  <div>‚ù§Ô∏è Nyawa: <span id="lives">10</span></div>
</div>

<div id="overlay">
  <h2>Space Catch ‚ú®</h2>
  <p>Gerakkan kapal dengan tombol ‚Üê ‚Üí atau tombol di layar!</p>
  <button id="startBtn">Mulai Game</button>
</div>

<div class="touch" id="touchControls" style="display:none">
  <div class="touch-btn" id="leftBtn">‚óÄÔ∏è</div>
  <div class="touch-btn" id="rightBtn">‚ñ∂Ô∏è</div>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
let cw,ch;
function resize(){
  cw=window.innerWidth;
  ch=window.innerHeight*0.8;
  canvas.width=cw;
  canvas.height=ch;
}
window.addEventListener("resize",resize);
resize();

let running=false,score=0,lives=3,stars=[],player={x:cw/2,y:ch-60,w:70,h:18,vx:0};
const scoreEl=document.getElementById("score"),livesEl=document.getElementById("lives");
const overlay=document.getElementById("overlay");
const touchControls=document.getElementById("touchControls");

const audioCtx=new (window.AudioContext||window.webkitAudioContext)();
function playSound(type){
  const o=audioCtx.createOscillator(),g=audioCtx.createGain();
  o.connect(g);g.connect(audioCtx.destination);
  if(type==="catch")o.frequency.value=900;
  if(type==="lose")o.frequency.value=220;
  if(type==="start")o.frequency.value=600;
  g.gain.setValueAtTime(0.1,audioCtx.currentTime);
  g.gain.exponentialRampToValueAtTime(0.0001,audioCtx.currentTime+0.4);
  o.start();o.stop(audioCtx.currentTime+0.5);
}

let keys={};
document.addEventListener("keydown",e=>{
  if(e.key==="ArrowLeft")keys.left=true;
  if(e.key==="ArrowRight")keys.right=true;
});
document.addEventListener("keyup",e=>{
  if(e.key==="ArrowLeft")keys.left=false;
  if(e.key==="ArrowRight")keys.right=false;
});

const leftBtn=document.getElementById("leftBtn");
const rightBtn=document.getElementById("rightBtn");
if('ontouchstart' in window || navigator.maxTouchPoints>0){touchControls.style.display="flex";}
let leftHeld=false,rightHeld=false;
leftBtn.addEventListener("pointerdown",()=>{leftHeld=true});
leftBtn.addEventListener("pointerup",()=>{leftHeld=false});
rightBtn.addEventListener("pointerdown",()=>{rightHeld=true});
rightBtn.addEventListener("pointerup",()=>{rightHeld=false});

document.getElementById("startBtn").onclick=()=>{
  overlay.style.display="none";
  playSound("start");
  startGame();
};

function startGame(){
  running=true;score=0;lives=3;stars=[];player.x=cw/2;
  scoreEl.textContent=score;livesEl.textContent=lives;
  lastTime=0;
  requestAnimationFrame(loop);
}

let lastTime=0,spawnTimer=0;
function loop(ts){
  if(!running)return;
  const dt=ts-lastTime;lastTime=ts;
  update(dt);draw();
  requestAnimationFrame(loop);
}

function update(dt){
  const left=keys.left||leftHeld;
  const right=keys.right||rightHeld;
  player.vx=(left?-1:right?1:0)*300;
  player.x+=player.vx*dt/1000;
  player.x=Math.max(player.w/2,Math.min(cw-player.w/2,player.x));

  spawnTimer+=dt;
  const interval=1000;
  if(spawnTimer>interval){spawnTimer=0;spawnStar();}

  for(let i=stars.length-1;i>=0;i--){
    const s=stars[i];
    s.y+=s.vy*dt/1000;
    if(s.y>ch){
      stars.splice(i,1);
      lives--;livesEl.textContent=lives;
      playSound("lose");
      if(lives<=0)gameOver();
    }
    if(s.y>player.y-10 && Math.abs(s.x-player.x)<player.w/2){
      stars.splice(i,1);
      score+=10;scoreEl.textContent=score;
      playSound("catch");
    }
  }
}

function draw(){
  const g=ctx.createLinearGradient(0,0,0,ch);
  g.addColorStop(0,"#0b0430");g.addColorStop(1,"#170b45");
  ctx.fillStyle=g;ctx.fillRect(0,0,cw,ch);
  ctx.fillStyle="#8be9fd";
  ctx.fillRect(player.x-player.w/2,player.y-player.h/2,player.w,player.h);

  for(const s of stars){
    ctx.save();ctx.translate(s.x,s.y);ctx.rotate(s.rot);
    ctx.fillStyle="#ffd86b";
    ctx.beginPath();
    for(let i=0;i<5;i++){
      const a=i*Math.PI*2/5;
      ctx.lineTo(Math.cos(a)*s.r,Math.sin(a)*s.r);
      ctx.lineTo(Math.cos(a+Math.PI/5)*s.r*0.5,Math.sin(a+Math.PI/5)*s.r*0.5);
    }
    ctx.closePath();ctx.fill();ctx.restore();
  }
}

function spawnStar(){
  const speed=50+Math.random()*50+score*0.3;
  stars.push({x:Math.random()*(cw-40)+20,y:-10,vy:speed,rot:Math.random()*6.28,r:8+Math.random()*6});
}

function gameOver(){
  running=false;
  overlay.innerHTML=`<h2>Game Over üò≠</h2><p>Skor kamu: ${score}</p><button id="restartBtn">Main Lagi</button>`;
  overlay.style.display="flex";
  document.getElementById("restartBtn").onclick=()=>{
    overlay.innerHTML=`<h2>Space Catch ‚ú®</h2><p>Gerakkan kapal dengan tombol ‚Üê ‚Üí atau tombol di layar!</p><button id="startBtn">Mulai Game</button>`;
    document.getElementById("startBtn").onclick=()=>{
      overlay.style.display="none";playSound("start");startGame();
    };
  };
}
</script>
</body>
</html>